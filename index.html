<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Merry Christmas! ğŸ„</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; user-select: none; }
        
        /* --- å‡çº§åçš„æ–‡å­—æ ·å¼ --- */
        #info {
            position: absolute; 
            top: 20px; 
            width: 100%; 
            text-align: center;
            /* ä½¿ç”¨è‰ºæœ¯å­—ä½“ */
            font-family: 'Great Vibes', cursive; 
            font-size: 60px; /* å­—å·åŠ å¤§ */
            
            /* é‡‘è‰²æ¸å˜å¡«å…… */
            background: linear-gradient(to bottom, #fffebd, #ffd700); 
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            
            /* æŸ”å’Œçš„é‡‘è‰²å…‰æ™• */
            filter: drop-shadow(0 0 10px #ffaa00);
            
            pointer-events: none; 
            z-index: 10;
            
            /* æµ®åŠ¨åŠ¨ç”» */
            animation: floatText 3s ease-in-out infinite;
        }

        @keyframes floatText {
            0%, 100% { transform: translateY(0); filter: drop-shadow(0 0 10px #ffaa00); }
            50% { transform: translateY(-10px); filter: drop-shadow(0 0 20px #ffaa00); }
        }

        /* --- éŸ³ä¹æŒ‰é’®æ ·å¼ --- */
        #music-btn {
            position: absolute;
            bottom: 30px;
            right: 30px;
            z-index: 20;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-family: sans-serif;
            font-size: 14px;
            backdrop-filter: blur(5px);
            transition: 0.3s;
        }
        #music-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
    </style>
    
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>
<body>
    <div id="info">Merry Christmas & Happy New Year</div>

    <button id="music-btn">ğŸµ Play Music</button>
    
    <audio id="bgm" loop>
        <source src="https://commondatastorage.googleapis.com/codeskulptor-demos/riceracer_assets/music/win.ogg" type="audio/ogg">
        </audio>
    
    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // --- éŸ³ä¹æ§åˆ¶é€»è¾‘ ---
        const musicBtn = document.getElementById('music-btn');
        const bgm = document.getElementById('bgm');
        let isPlaying = false;

        musicBtn.addEventListener('click', () => {
            if (isPlaying) {
                bgm.pause();
                musicBtn.textContent = "ğŸµ Play Music";
                musicBtn.style.color = "white";
            } else {
                bgm.play().then(() => {
                    musicBtn.textContent = "ğŸµ Pause";
                    musicBtn.style.color = "#ffd700"; // æ’­æ”¾æ—¶å˜é‡‘è‰²
                }).catch(e => console.log("æ’­æ”¾å¤±è´¥ï¼Œè¯·äº¤äº’", e));
            }
            isPlaying = !isPlaying;
        });

        // --- ä»¥ä¸‹æ˜¯åŸæœ‰çš„ 3D åœºæ™¯ä»£ç  (ä¿æŒä¸å˜) ---

        // 1. åœºæ™¯ä¸ç›¸æœº
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x000000, 0.02);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 3, 8);

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        document.body.appendChild(renderer.domElement);

        // 2. æ§åˆ¶å™¨
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 1.0;

        // 3. åˆ›å»ºåœ£è¯æ ‘
        function createTree() {
            const treeGroup = new THREE.Group();

            const leaveMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x0f5f0f, roughness: 0.3, metalness: 0.1 
            });

            const trunkGeo = new THREE.CylinderGeometry(0.5, 0.8, 2, 8);
            const trunkMat = new THREE.MeshStandardMaterial({ color: 0x4d2926 });
            const trunk = new THREE.Mesh(trunkGeo, trunkMat);
            trunk.position.y = -1;
            treeGroup.add(trunk);

            const levels = [
                { radius: 2.5, height: 3, y: 0.5 },
                { radius: 2.0, height: 2.5, y: 2.0 },
                { radius: 1.5, height: 2.0, y: 3.2 },
                { radius: 1.0, height: 1.5, y: 4.2 }
            ];

            levels.forEach(level => {
                const geometry = new THREE.ConeGeometry(level.radius, level.height, 16);
                const mesh = new THREE.Mesh(geometry, leaveMaterial);
                mesh.position.y = level.y;
                treeGroup.add(mesh);
            });

            const starGeo = new THREE.OctahedronGeometry(0.5, 0);
            const starMat = new THREE.MeshBasicMaterial({ color: 0xffd700 });
            const star = new THREE.Mesh(starGeo, starMat);
            star.position.y = 5.2;
            treeGroup.add(star);
            
            const bulbGeo = new THREE.SphereGeometry(0.15, 8, 8);
            const colors = [0xff0000, 0x00ff00, 0x0000ff, 0xffff00, 0xff00ff];
            
            for(let i=0; i<30; i++) {
                const mat = new THREE.MeshBasicMaterial({ color: colors[Math.floor(Math.random()*colors.length)] });
                const bulb = new THREE.Mesh(bulbGeo, mat);
                const angle = i * 0.5; 
                const y = i * 0.15 + 0.5;
                const r = 2.2 - i * 0.05; 
                if (r > 0) {
                    bulb.position.set(Math.cos(angle)*r, y, Math.sin(angle)*r);
                    treeGroup.add(bulb);
                }
            }

            return { group: treeGroup, star: star };
        }

        const treeObj = createTree();
        scene.add(treeObj.group);

        const plane = new THREE.Mesh(
            new THREE.PlaneGeometry(200, 200),
            new THREE.MeshStandardMaterial({ color: 0x111111 })
        );
        plane.rotation.x = -Math.PI / 2;
        plane.position.y = -2;
        scene.add(plane);

        const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
        scene.add(ambientLight);

        const pointLight = new THREE.PointLight(0xffaa00, 50, 20);
        pointLight.position.set(5, 5, 5);
        scene.add(pointLight);

        const snowGeo = new THREE.BufferGeometry();
        const snowCount = 3000;
        const posArray = new Float32Array(snowCount * 3);
        const velocityArray = [];

        for(let i=0; i<snowCount * 3; i+=3) {
            posArray[i] = (Math.random() - 0.5) * 50;
            posArray[i+1] = (Math.random() - 0.5) * 40 + 10;
            posArray[i+2] = (Math.random() - 0.5) * 50;
            velocityArray.push((Math.random() * 0.05) + 0.02);
        }
        snowGeo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        const snowMat = new THREE.PointsMaterial({
            size: 0.1, color: 0xffffff, transparent: true, opacity: 0.8
        });
        const snowMesh = new THREE.Points(snowGeo, snowMat);
        scene.add(snowMesh);

        function animate() {
            requestAnimationFrame(animate);
            controls.update();

            const positions = snowGeo.attributes.position.array;
            for(let i=1; i<snowCount*3; i+=3) {
                positions[i] -= velocityArray[(i-1)/3];
                if (positions[i] < -2) {
                    positions[i] = 20;
                }
            }
            snowGeo.attributes.position.needsUpdate = true;

            const time = Date.now() * 0.005;
            treeObj.star.scale.setScalar(1 + Math.sin(time) * 0.2);

            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
